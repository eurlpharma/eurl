import{F as G,G as M,u as O,a0 as H,r,N as J,j as s,C as m,a2 as u,aj as p,T as a,ai as x,Z as v,a8 as y,B as N,P,I as k,a9 as K,ap as Q,aq as U}from"./index-d1e9d783.js";import{c as X,a as S,b as Y,u as _,o as ss}from"./index.esm-590aa197.js";import{I as T}from"./InputAdornment-06a64392.js";import{E as I}from"./EyeSlashIcon-80eca774.js";import{E as C}from"./EyeIcon-1bf2a3b0.js";const ns=()=>{var b,g;const{t:e}=G(),l=M(),q=O(),{token:t}=H(),[n,E]=r.useState(!1),[i,R]=r.useState(!1),[L,W]=r.useState(!1),[z,h]=r.useState(!0),[A,w]=r.useState(!1),{loading:o,error:j}=J(d=>d.auth);r.useEffect(()=>{(async()=>{if(!t){h(!1),w(!0);return}try{await l(Q(t)).unwrap(),h(!0)}catch{h(!1)}finally{w(!0)}})()},[l,t]);const $=X().shape({password:S().required(e("validation.required")).min(8,e("validation.passwordLength")).matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/,e("validation.passwordRequirements")),confirmPassword:S().oneOf([Y("password")],e("validation.passwordsMatch")).required(e("validation.required"))}),{register:f,handleSubmit:B,formState:{errors:c}}=_({resolver:ss($)}),F=async d=>{if(t)try{await l(U({token:t,password:d.password})).unwrap(),W(!0),setTimeout(()=>{q("/auth/login")},3e3)}catch{}},Z=()=>{E(!n)},V=()=>{R(!i)};return A?z?s.jsx(m,{maxWidth:"sm",className:"py-12",children:s.jsxs(u,{elevation:3,className:"p-8",children:[s.jsx(a,{variant:"h4",component:"h1",className:"text-center mb-6 font-bold",children:e("auth.resetPassword")}),j&&s.jsx(x,{severity:"error",className:"mb-4",children:j}),L?s.jsxs(N,{children:[s.jsx(x,{severity:"success",className:"mb-4",children:e("auth.passwordResetSuccess")}),s.jsx(a,{variant:"body1",className:"mb-4",children:e("auth.redirectingToLogin")}),s.jsx(p,{size:24,className:"mx-auto block"})]}):s.jsxs(s.Fragment,{children:[s.jsx(a,{variant:"body1",className:"mb-6",children:e("auth.resetPasswordInstructions")}),s.jsxs("form",{onSubmit:B(F),className:"space-y-4",children:[s.jsx(P,{label:e("auth.newPassword"),type:n?"text":"password",fullWidth:!0,...f("password"),error:!!c.password,helperText:(b=c.password)==null?void 0:b.message,disabled:o,InputProps:{endAdornment:s.jsx(T,{position:"end",children:s.jsx(k,{onClick:Z,edge:"end","aria-label":n?"hide password":"show password",children:n?s.jsx(I,{className:"w-5 h-5"}):s.jsx(C,{className:"w-5 h-5"})})})}}),s.jsx(P,{label:e("auth.confirmPassword"),type:i?"text":"password",fullWidth:!0,...f("confirmPassword"),error:!!c.confirmPassword,helperText:(g=c.confirmPassword)==null?void 0:g.message,disabled:o,InputProps:{endAdornment:s.jsx(T,{position:"end",children:s.jsx(k,{onClick:V,edge:"end","aria-label":i?"hide password":"show password",children:i?s.jsx(I,{className:"w-5 h-5"}):s.jsx(C,{className:"w-5 h-5"})})})}}),s.jsx(v,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,size:"large",disabled:o,startIcon:o&&s.jsx(p,{size:20,color:"inherit"}),children:e(o?"common.loading":"auth.resetPassword")}),s.jsx(N,{className:"text-center mt-4",children:s.jsxs(a,{variant:"body2",children:[e("auth.rememberPassword")," ",s.jsx(K,{component:y,to:"/auth/login",underline:"hover",children:e("auth.login")})]})})]})]})]})}):s.jsx(m,{maxWidth:"sm",className:"py-12",children:s.jsxs(u,{elevation:3,className:"p-8",children:[s.jsx(a,{variant:"h4",component:"h1",className:"text-center mb-6 font-bold",children:e("auth.invalidToken")}),s.jsx(x,{severity:"error",className:"mb-4",children:e("auth.resetLinkInvalid")}),s.jsx(a,{variant:"body1",className:"mb-4",children:e("auth.resetLinkExpired")}),s.jsx(v,{component:y,to:"/auth/forgot-password",variant:"contained",color:"primary",fullWidth:!0,children:e("auth.requestNewLink")})]})}):s.jsx(m,{maxWidth:"sm",className:"py-12",children:s.jsxs(u,{elevation:3,className:"p-8 text-center",children:[s.jsx(p,{size:40,className:"mb-4"}),s.jsx(a,{children:e("common.loading")})]})})};export{ns as default};
