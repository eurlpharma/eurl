import{F as B,G as L,u as O,r as a,N as _,j as e,B as c,T as y,Q as $,P as z,a2 as G,I as w,a8 as M,Z as T}from"./index-d1e9d783.js";import{u as U}from"./useNotification-a88ee381.js";import{getProducts as i,deleteProduct as W}from"./productSlice-d1b9c26d.js";import{P as H}from"./PlusIcon-436a5931.js";import{I as Q}from"./InputAdornment-06a64392.js";import{M as V}from"./MagnifyingGlassIcon-2b85ffcf.js";import{T as Z,a as q,b as J,c as l,d as o,e as K}from"./TableRow-af3e354d.js";import{C as b}from"./Chip-d0686d0b.js";import{P as X}from"./PencilIcon-564e0e25.js";import{T as Y}from"./TrashIcon-f581e95b.js";import{T as ee}from"./TablePagination-4d1bd4b8.js";import{D as se,a as te,b as oe,c as re}from"./DialogTitle-85b1fe0b.js";import{D as ae}from"./DialogContentText-cadfe350.js";import"./KeyboardArrowRight-68c72fff.js";import"./LastPage-863d5f50.js";const ne={}.VITE_API_URL||"https://eurl-server.onrender.com",Te=()=>{const{t}=B(),{success:C}=U(),n=L(),D=O(),[d,x]=a.useState(0),[m,I]=a.useState(10),[h,v]=a.useState(""),[N,p]=a.useState(!1),[j,P]=a.useState(null),{products:g,loading:S,error:f,totalProducts:R}=_(s=>s.products);a.useEffect(()=>{(async()=>{try{const r=n(i({page:d+1,limit:m,keyword:h}));if(i.rejected.match(r))throw new Error(r.payload)}catch{return!1}})()},[n,d,m,h]),a.useEffect(()=>{(async()=>{try{const r=n(i({page:1,limit:10}));if(i.rejected.match(r))throw new Error(r.payload)}catch{return!1}})()},[n]);const k=(s,r)=>{x(r)},A=s=>{const r=parseInt(s.target.value,10);I(r),x(0)},E=s=>{P(s),p(!0)},u=()=>{p(!1),P(null)},F=async()=>{if(j)try{await n(W(j)).unwrap(),C(t("admin.productDeleted")),n(i({page:d+1,limit:m,keyword:h}))}catch{return}finally{u()}};return e.jsxs(c,{className:"p-4",children:[e.jsxs(c,{className:"flex justify-between items-center mb-6",children:[e.jsx(y,{variant:"h4",component:"h1",className:"font-semibold font-josefin",children:t("admin.products")}),e.jsx($,{onClick:()=>D("/admin/products/add"),variant:"outlined",color:"primary",startContent:e.jsx(H,{className:"w-5 h-5"}),children:t("admin.addProduct")})]}),e.jsx(c,{className:"mb-4",children:e.jsx(z,{fullWidth:!0,variant:"outlined",placeholder:t("common.search"),value:h,onChange:s=>v(s.target.value),InputProps:{startAdornment:e.jsx(Q,{position:"start",children:e.jsx(V,{className:"w-5 h-5 text-gray-500"})})}})}),e.jsxs(Z,{component:G,children:[e.jsxs(q,{children:[e.jsx(J,{children:e.jsxs(l,{children:[e.jsx(o,{children:t("products.image")}),e.jsx(o,{children:t("products.name")}),e.jsx(o,{children:t("products.price")}),e.jsx(o,{children:t("products.category")}),e.jsx(o,{children:t("products.stock")}),e.jsx(o,{children:t("products.featured")}),e.jsx(o,{align:"right",children:t("common.actions")})]})}),e.jsx(K,{children:S?e.jsx(l,{children:e.jsx(o,{colSpan:7,align:"center",children:t("common.loading")})}):f?e.jsx(l,{children:e.jsx(o,{colSpan:7,align:"center",children:e.jsxs(y,{color:"error",children:[t("common.errorFetchingData"),": ",f]})})}):g&&g.length>0?g.map(s=>{var r;return e.jsxs(l,{children:[e.jsx(o,{children:s.images&&s.images.length>0?e.jsx(c,{component:"img",src:s.images[0].startsWith("http")?s.images[0]:`${ne}${s.images[0]}`,alt:s.name,sx:{width:50,height:50,objectFit:"cover",borderRadius:1}}):e.jsx(c,{component:"img",src:"/placeholder.png",alt:"No image",sx:{width:50,height:50,objectFit:"cover",borderRadius:1}})}),e.jsx(o,{children:s.name}),e.jsxs(o,{children:[s.price," DA"]}),e.jsx(o,{children:((r=s.category)==null?void 0:r.name)||s.category}),e.jsx(o,{children:s.countInStock}),e.jsx(o,{children:s.isFeatured?e.jsx(b,{label:t("common.yes"),color:"primary",size:"small"}):e.jsx(b,{label:t("common.no"),color:"default",size:"small"})}),e.jsxs(o,{align:"right",children:[e.jsx(w,{component:M,to:`/admin/products/edit/${s.id}`,color:"primary",children:e.jsx(X,{className:"w-5 h-5"})}),e.jsx(w,{color:"error",onClick:()=>E(s.id),children:e.jsx(Y,{className:"w-5 h-5"})})]})]},s.id)}):e.jsx(l,{children:e.jsx(o,{colSpan:7,align:"center",children:t("products.noProductsFound")})})})]}),e.jsx(ee,{rowsPerPageOptions:[5,10,25],component:"div",count:R||0,rowsPerPage:m,page:d,onPageChange:k,onRowsPerPageChange:A,labelRowsPerPage:t("common.rowsPerPage")})]}),e.jsxs(se,{open:N,onClose:u,children:[e.jsx(te,{children:t("admin.deleteProductTitle")}),e.jsx(oe,{children:e.jsx(ae,{children:t("admin.deleteProductConfirmation")})}),e.jsxs(re,{children:[e.jsx(T,{onClick:u,color:"primary",children:t("common.cancel")}),e.jsx(T,{onClick:F,color:"error",children:t("common.delete")})]})]})]})};export{Te as default};
